---
sourceId: managed:datastax
integrationDefinitionId: '${integration_definition_id}'
questions: 
- id: managed-question-datastax-databases-with-available-actions-that-are-serviced-via-GCP
  title: Which Datastax databases with available actions are being serviced by GCP?
  description: Returns a list of active DataStax databases with available actions running in a GCP cloud.
  queries:
      - name: informative
        query: |
          FIND * WITH _integrationType ~='datastax' AND  _class != "AccessRole" AND active = true AND observedStatus ~= 'ACTIVE' AND info.cloudProvider ~= "GCP" 
  tags:
      - datastax
      - database
     

- id: managed-question-datastax-api-roles-containing-database-policy-actions-use-graphql
  title: Which Datastax API roles containing database policy actions use GraphQL?
  description: Returns a list of DataStax API roles with database policy actions that use GraphQL.
  queries:
      - name: informative
        query: |
          FIND datastax_access_role with name ~= 'API' AS role
            THAT HAS datastax_organization
            THAT HAS datastax_database AS db
          RETURN
            role.displayName AS "API Roles", role.policy.actions AS "Policy Actions",
            db.name AS "Database Name", db.graphqlUrl AS GraphQL
  tags:
      - datastax
      - rbac
      - database